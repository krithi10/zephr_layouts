<style>
  .met-header-toast {
    box-shadow: 0 1px 4px 0 #9B9B9B;
    -webkit-transition: -webkit-transform 375ms cubic-bezier(0.2, 0.84, 0.46, 0.99);
    -moz-transition: -moz-transform 375ms cubic-bezier(0.2, 0.84, 0.46, 0.99);
    transition: transform 375ms cubic-bezier(0.2, 0.84, 0.46, 0.99);
    z-index: 30;
  }
  .met-header-toast.closed {
    -webkit-transform: translateY(-150%);
    -moz-transform: translateY(-150%);
    -ms-transform: translateY(-150%);
    -o-transform: translateY(-150%);
    transform: translateY(-150%);
    -webkit-transition: -webkit-transform 0.15s linear;
    -moz-transition: -moz-transform 0.15s linear;
    transition: transform 0.15s linear;
  }
  .met-header-toast [data-met-return] {
    text-align: center;
    font: 400 14px/40px {{font}}, Arial, sans-serif;
    text-decoration: none;
    white-space: nowrap;
    display: block;
    background-color: {{background-color}};
    color: {{default-color}};
    letter-spacing: 1px;
  }
  .met-header-toast [data-met-return] b {
    font-weight: 700;
  }
  .met-header-toast [data-met-return] mark {
    color: {{highlight-color}};
    background: none;
  }
  .met-header-toast .met-toast-close0 {
    display: none;
  }
  .met-header-toast .met-toast-close2 {
    position: relative;
  }
  .met-header-toast .met-flyout-close {
      cursor: pointer;
      display: table-cell;
      position: absolute;
      right: 20px;
      top: 10px;
      width: 16px;
      height: 16px;
  }
  .met-header-toast .met-flyout-close::after, .met-header-toast .met-flyout-close::before {
      content: '';
      position: absolute;
      height: 4px;
      top: 50%;
      background-color: {{close-button-color}};
      width: 90%;
  }
  .met-header-toast .met-flyout-close::before {
      -webkit-transform: rotate(45deg);
      -moz-transform: rotate(45deg);
      -ms-transform: rotate(45deg);
      -o-transform: rotate(45deg);
      transform: rotate(45deg);
  }
  .met-header-toast .met-flyout-close::after {
      -webkit-transform: rotate(-45deg);
      -moz-transform: rotate(-45deg);
      -ms-transform: rotate(-45deg);
      -o-transform: rotate(-45deg);
      transform: rotate(-45deg);
  }
  /*@media only screen and (min-width: 548px) {
    .met-header-toast {
      display: none;
    }
  }*/
</style>
<div class="met-header-toast" style="display: none">
  <div class="met-toast-close{{closeable}}">
    <a href="#" class="met-flyout-close"></a>
  </div>
  <a href="{{subscribe-url}}" data-met-return
    >{{tagline}}&nbsp;|&nbsp;<b><mark>{{description}}</mark></b>
  </a>
</div>
<script>
  /* Zephr-6957: scope-lock fix - Toaster functionality which is use triggered multiple times once we include the Geo-Location configuartion */
  var lock = 'toaster-header';
  ((scope) => {
    if (scope[lock]) return;
    scope[lock] = true;
    /* DSS-15778 - Any change in the code nust be updated in the Footer-toaster component */
    let elem = document.querySelector("[data-reg-role='prompt']");
    let toasterElem = document.querySelector(".met-header-toast");
    const closeArry = localStorage.getItem("trb.zephr.closeDates") ? JSON.parse(localStorage.getItem("trb.zephr.closeDates")): [];
    const withinDate = closeArry.filter(closeData => Math.round(new Date().getTime() - closeData.expirationDate)/(1000 * 3600 * 24)<180);
    const exceedDate = closeArry.filter(closeData => Math.round(new Date().getTime() - closeData.expirationDate)/(1000 * 3600 * 24)>180);

    if(exceedDate.length> 0 && withinDate.length!== 0){
      localStorage.setItem("trb.zephr.closeDates", JSON.stringify(withinDate));
    }else if (withinDate.length=== 0){
      localStorage.removeItem("trb.zephr.closeDates");
    }
    const closedDateCheck = withinDate.filter(closeData => closeData.campaign !== "" && closeData.campaign !== " " && new Date().getTime() < closeData.expirationDate);
    const newCampaignCheck = withinDate.filter(closeData => closeData.campaign !== "" && closeData.campaign !== " " && closeData.campaign === '{{slug}}');
    if(elem && (closedDateCheck.length === 0 || newCampaignCheck.length === 0)){
      document.querySelector("[data-reg-role='prompt']").appendChild(toasterElem);
      document.querySelector(".met-header-toast").style.display="block";
      console.log('-----Display Mobile-Toaster----------');
      /*DSS-15551- suppress the Mobile-web Toaster*/
      if(elem.hasAttribute("data-dss-condense") && elem.getAttribute("data-dss-condense")=== "true"){
        document.querySelector(".met-header-toast").style.height= "40px";
        document.querySelector(".met-flyout-close").style.display= "none";
             }
    }
    else{
      console.log('-----No Mobile-Toaster----------');
      document.querySelector(".met-header-toast").remove();
      dataLayer.push({'header_toaster': 'display_not'});
    }
    const closeBtnElem = document.querySelector(".met-flyout-close");
    if(closeBtnElem){
      document.querySelector(".met-flyout-close").addEventListener('click',function(e){
        e.preventDefault();
         let toasterElem = document.querySelector(".met-header-toast");
          console.log('-----close button clicked----------');
          if(toasterElem && !toasterElem.classList.contains("closed")){
            let closeArry = JSON.parse(localStorage.getItem("trb.zephr.closeDates") || "[]");
            const closeDate = new Date().getTime() + (86400000*{{reset-days}});
            const closeDetails = {
              'campaign': '{{slug}}',
              'expirationDate': closeDate,
              'status': 'closed'
            };
            closeArry.push(closeDetails);
            localStorage.setItem("trb.zephr.closeDates", JSON.stringify(closeArry));
            document.querySelector(".met-header-toast").classList.add("closed");
            document.querySelector(".met-header-toast").remove();
            dataLayer.push({'header_toaster': 'display_not'});
         }
      });
    }
  })(Window);
</script>
